<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Área do Motorista - Kanghoo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/bundle.min.css">
    <script src="../assets/js/vendors/chart.min.js"></script>
    <script src="../assets/js/api/rastreamento-api.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --white: #ffffff;
            --border-color: #e9ecef;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #0dcaf0;
            --light-color: #212529;
            --dark-color: #f8f9fa;
            --white: #1a1a1a;
            --border-color: #495057;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            transition: var(--transition);
        }

        /* Header Melhorado */
        .header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--light-color);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--dark-color);
            font-size: 1.2rem;
            position: relative;
            overflow: hidden;
        }

        .theme-toggle:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background: var(--white);
            transform: scale(1.1);
            box-shadow: var(--shadow);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        [data-theme="dark"] .theme-toggle {
            background: var(--dark-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* Container Principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Dashboard Overview */
        .dashboard-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .dashboard-card.success {
            border-left-color: var(--success-color);
        }

        .dashboard-card.warning {
            border-left-color: var(--warning-color);
        }

        .dashboard-card.danger {
            border-left-color: var(--danger-color);
        }

        .dashboard-card.info {
            border-left-color: var(--info-color);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-weight: 500;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light-color);
            color: var(--primary-color);
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .card-change {
            font-size: 0.8rem;
            font-weight: 500;
        }

        .card-change.positive {
            color: var(--success-color);
        }

        .card-change.negative {
            color: var(--danger-color);
        }

        /* Tabs Container */
        .tabs-container {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .tabs-nav {
            display: flex;
            background: var(--light-color);
            overflow-x: auto;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--secondary-color);
            transition: var(--transition);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 3px solid transparent;
            position: relative;
            min-width: 120px;
            justify-content: center;
            font-size: 0.9rem;
        }

        .tab-button.active {
            color: var(--primary-color);
            background: var(--white);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
            box-shadow: 0 -2px 8px rgba(0, 123, 255, 0.1);
        }

        .tab-button:hover:not(.active) {
            background: rgba(0, 123, 255, 0.1);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .tab-button i {
            font-size: 1rem;
        }

        .tab-content {
            padding: 2rem;
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Botões */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #1e7e34;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .btn-blue {
            background: var(--info-color);
            color: white;
        }

        .btn-blue:hover {
            background: #138496;
            transform: translateY(-1px);
        }

        .btn-logout {
            background: var(--danger-color);
            color: white;
            padding: 0.5rem 1rem;
        }

        .btn-logout:hover {
            background: #c82333;
        }

        /* Status de Viagem */
        .trip-status-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .trip-status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--danger-color);
        }

        .status-dot.active {
            background: var(--success-color);
            animation: pulse 2s infinite;
        }

        /* Detalhes da Viagem */
        .viagem-detalhes-container {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
        }

        .viagem-info h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .viagem-info p {
            margin: 0.5rem 0;
            color: var(--dark-color);
        }

        .viagem-info strong {
            color: var(--secondary-color);
            font-weight: 600;
        }

        .dados-simulados-info {
            background: rgba(23, 162, 184, 0.1);
            border: 1px solid var(--info-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-top: 1rem;
        }

        .dados-simulados-info i {
            margin-right: 0.5rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .status-text {
            font-weight: 500;
            color: var(--dark-color);
        }

        /* Lista de Crianças */
        .children-list {
            margin-top: 2rem;
        }

        .children-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .child-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .child-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .child-card.checked-in {
            border-left: 4px solid var(--success-color);
        }

        .child-card.checked-out {
            border-left: 4px solid var(--secondary-color);
        }

        .child-info {
            margin-bottom: 1rem;
        }

        .child-name {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .child-details {
            font-size: 0.9rem;
            color: var(--secondary-color);
        }

        .child-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Gráficos */
        .chart-container {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .chart-canvas {
            position: relative;
            height: 300px;
        }

        /* Relatórios */
        .report-filters {
            display: flex;
            gap: 1rem;
            align-items: end;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-group label {
            font-weight: 500;
            color: var(--dark-color);
        }

        .filter-group select,
        .filter-group input {
            padding: 0.5rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background: var(--white);
            color: var(--dark-color);
            transition: var(--transition);
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .report-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .report-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .report-icon.trips {
            background: rgba(0, 123, 255, 0.1);
            color: var(--primary-color);
        }

        .report-icon.distance {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }

        .report-icon.fuel {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning-color);
        }

        .report-icon.children {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .report-content h4 {
            margin: 0;
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .report-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-color);
        }

        /* Tabelas */
        .report-table {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            background: var(--light-color);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .table-title {
            font-weight: 600;
            color: var(--dark-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--light-color);
            font-weight: 600;
            color: var(--dark-color);
        }

        td {
            color: var(--secondary-color);
        }

        /* Estilos para Rotas Escolares */
        .plan-status-card {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .plan-info h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.5rem;
        }

        .plan-info p {
            margin: 0;
            opacity: 0.9;
        }

        .plan-usage {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .usage-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .usage-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 0.25rem;
        }

        .usage-value {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .routes-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .routes-container {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .routes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .routes-header h3 {
            margin: 0;
            color: var(--dark-color);
        }

        .routes-filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .routes-filters select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--white);
            color: var(--dark-color);
            font-size: 0.9rem;
        }

        .routes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .route-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
            position: relative;
        }

        .route-card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .route-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
            margin: 0;
        }

        .route-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .route-status.ativa {
            background: #d4edda;
            color: #155724;
        }

        .route-status.inativa {
            background: #f8d7da;
            color: #721c24;
        }

        .route-status.pausada {
            background: #fff3cd;
            color: #856404;
        }

        .route-details {
            margin-bottom: 1rem;
        }

        .route-detail {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--secondary-color);
        }

        .route-detail i {
            width: 16px;
            margin-right: 0.5rem;
            color: var(--primary-color);
        }

        .route-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--secondary-color);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--border-color);
        }

        .empty-state h4 {
            margin: 0 0 0.5rem 0;
            color: var(--dark-color);
        }

        .empty-state p {
            margin: 0 0 1.5rem 0;
        }

        .routes-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-card:nth-child(1) .stat-icon {
            background: var(--primary-color);
        }

        .stat-card:nth-child(2) .stat-icon {
            background: var(--success-color);
        }

        .stat-card:nth-child(3) .stat-icon {
            background: var(--danger-color);
        }

        .stat-card:nth-child(4) .stat-icon {
            background: var(--warning-color);
        }

        .stat-content h4 {
            margin: 0 0 0.25rem 0;
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
        }

        .stat-content p {
            margin: 0;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }

        .badge {
            background: var(--danger-color);
            color: white;
            border-radius: 50%;
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
            min-width: 18px;
            text-align: center;
        }

        /* Modal de Rotas */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
            margin: 0;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-color);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--danger-color);
        }

        .route-form {
            padding: 1.5rem;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--light-color);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }

        .form-section h3 {
            margin: 0 0 1rem 0;
            color: var(--dark-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.9rem;
            transition: var(--transition);
            background: var(--white);
            color: var(--dark-color);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
            }

            .dashboard-overview {
                grid-template-columns: 1fr;
            }

            .tabs-nav {
                flex-direction: column;
            }

            .tab-button {
                justify-content: center;
            }

            .trip-status-header {
                flex-direction: column;
                align-items: stretch;
            }

            .children-grid {
                grid-template-columns: 1fr;
            }

            .report-filters {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                width: 100%;
            }

            .report-cards {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animações */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Estados de loading */
        .loading {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notificações */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 500;
            z-index: 10000;
            transform: translateX(400px);
            transition: var(--transition);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--danger-color);
        }

        .notification.warning {
            background: var(--warning-color);
        }

        .notification.info {
            background: var(--info-color);
        }

        /* Estilos da Seção de Perfil */
        .profile-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .profile-section {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .section-header {
            background: var(--light-color);
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header h3 {
            margin: 0;
            color: var(--dark-color);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .profile-photo-container {
            padding: 2rem;
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .profile-photo {
            position: relative;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            overflow: hidden;
            border: 4px solid var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }

        .profile-photo:hover {
            transform: scale(1.05);
        }

        .profile-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
            transition: var(--transition);
        }

        .profile-photo:hover .photo-overlay {
            opacity: 1;
        }

        .photo-overlay i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .profile-info {
            flex: 1;
        }

        .profile-info h4 {
            margin: 0 0 0.5rem 0;
            color: var(--dark-color);
            font-size: 1.5rem;
        }

        .profile-info p {
            margin: 0.25rem 0;
            color: var(--secondary-color);
        }

        .documents-grid {
            padding: 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .document-card {
            background: var(--light-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .document-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        .document-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .document-info {
            flex: 1;
        }

        .document-info h4 {
            margin: 0 0 0.5rem 0;
            color: var(--dark-color);
            font-size: 1.1rem;
        }

        .document-status {
            margin: 0.25rem 0;
            font-weight: 500;
        }

        .document-status:contains("Enviado") {
            color: var(--success-color);
        }

        .document-status:contains("Não enviado") {
            color: var(--danger-color);
        }

        .document-date {
            margin: 0;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }

        .document-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1rem;
        }

        .btn-icon.view-doc {
            background: var(--info-color);
            color: white;
        }

        .btn-icon.upload-doc {
            background: var(--primary-color);
            color: white;
        }

        .btn-icon:hover {
            transform: scale(1.1);
        }

        /* Responsividade para perfil */
        @media (max-width: 768px) {
            .profile-photo-container {
                flex-direction: column;
                text-align: center;
            }

            .documents-grid {
                grid-template-columns: 1fr;
            }

            .document-card {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header Melhorado -->
    <header class="header">
        <div class="header-container">
            <a href="../index.html" class="logo">
                <i class="fas fa-bus"></i>
                <span>Kanghoo</span>
            </a>
            
            <div class="header-actions">
                <button id="logout-button" class="btn btn-logout" title="Sair do sistema">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </button>
                <button class="theme-toggle" id="theme-toggle" title="Alternar tema">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Container Principal -->
    <div class="container">
        <!-- Dashboard Overview -->
        <div class="dashboard-overview fade-in">
            <div class="dashboard-card success">
                <div class="card-header">
                    <div class="card-title">Viagens Hoje</div>
                    <div class="card-icon">
                        <i class="fas fa-route"></i>
                    </div>
                </div>
                <div class="card-value" id="trips-today">0</div>
                <div class="card-change positive" id="trips-change">+0% vs ontem</div>
            </div>

            <div class="dashboard-card warning">
                <div class="card-header">
                    <div class="card-title">Receita Mensal</div>
                    <div class="card-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                </div>
                <div class="card-value" id="monthly-revenue">R$ 0</div>
                <div class="card-change positive" id="revenue-change">+0% vs mês anterior</div>
            </div>

            <div class="dashboard-card info">
                <div class="card-header">
                    <div class="card-title">Crianças Ativas</div>
                    <div class="card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="card-value" id="active-children">0</div>
                <div class="card-change positive" id="children-change">+0 novos</div>
            </div>

            <div class="dashboard-card danger">
                <div class="card-header">
                    <div class="card-title">Distância Total</div>
                    <div class="card-icon">
                        <i class="fas fa-road"></i>
                    </div>
                </div>
                <div class="card-value" id="total-distance">0 km</div>
                <div class="card-change positive" id="distance-change">+0 km hoje</div>
            </div>

            <div class="dashboard-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; cursor: pointer;" onclick="window.location.href='conferencia-criancas.html'">
                <div class="card-header">
                    <div class="card-title">Conferência de Crianças</div>
                    <div class="card-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                </div>
                <div class="card-value" style="color: white;">Gerenciar</div>
                <div class="card-change" style="color: rgba(255,255,255,0.8);">Embarque e desembarque</div>
            </div>
        </div>

        <!-- Tabs Container -->
        <div class="tabs-container fade-in">
            <div class="tabs-nav">
                <button class="tab-button active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                </button>
                <button class="tab-button" data-tab="profile">
                    <i class="fas fa-user"></i>
                    Perfil
                </button>
                <button class="tab-button" data-tab="trips">
                    <i class="fas fa-route"></i>
                    Controle de Viagens
                </button>
                <button class="tab-button" data-tab="routes">
                    <i class="fas fa-map-marked-alt"></i>
                    Gerenciar Rotas
                </button>
                <button class="tab-button" data-tab="tracking">
                    <i class="fas fa-map-marker-alt"></i>
                    Rastreamento
                </button>
                <button class="tab-button" data-tab="conferencia" onclick="window.location.href='conferencia-criancas.html'">
                    <i class="fas fa-clipboard-check"></i>
                    Conferência
                </button>
                <button class="tab-button" data-tab="reports">
                    <i class="fas fa-chart-bar"></i>
                    Relatórios
                </button>
                <button class="tab-button" data-tab="financial">
                    <i class="fas fa-dollar-sign"></i>
                    Financeiro
                </button>
            </div>

            <!-- Tab: Dashboard -->
            <div class="tab-content active" id="dashboard-tab">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Evolução Semanal</h3>
                        <div>
                            <button class="btn btn-primary" id="refresh-dashboard">
                                <i class="fas fa-sync-alt"></i>
                                Atualizar
                            </button>
                        </div>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="dashboard-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tab: Perfil -->
            <div class="tab-content" id="profile-tab">
                <div class="profile-container">
                    <!-- Seção de Foto de Perfil -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h3><i class="fas fa-user-circle"></i> Foto de Perfil</h3>
                        </div>
                        <div class="profile-photo-container">
                            <div class="profile-photo">
                                <img id="profile-image" src="../imagens/canguru.png" alt="Foto de Perfil" onerror="this.src='../imagens/canguru.png'">
                                <div class="photo-overlay">
                                    <i class="fas fa-camera"></i>
                                    <span>Alterar Foto</span>
                                </div>
                            </div>
                            <div class="profile-info">
                                <h4 id="motorista-nome">Nome do Motorista</h4>
                                <p id="motorista-email">email@exemplo.com</p>
                                <p id="motorista-telefone">(00) 00000-0000</p>
                                <button class="btn btn-primary" id="update-photo-btn">
                                    <i class="fas fa-upload"></i>
                                    Atualizar Foto
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Seção de Documentos -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h3><i class="fas fa-file-alt"></i> Documentos</h3>
                            <button class="btn btn-success" id="upload-documents-btn">
                                <i class="fas fa-plus"></i>
                                Adicionar Documento
                            </button>
                        </div>
                        <div class="documents-grid">
                            <div class="document-card" data-doc-type="cnh">
                                <div class="document-icon">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <div class="document-info">
                                    <h4>CNH</h4>
                                    <p class="document-status" id="cnh-status">Não enviado</p>
                                    <p class="document-date" id="cnh-date"></p>
                                </div>
                                <div class="document-actions">
                                    <button class="btn-icon view-doc" id="view-cnh" style="display: none;">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon upload-doc" id="upload-cnh">
                                        <i class="fas fa-upload"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="document-card" data-doc-type="crlv">
                                <div class="document-icon">
                                    <i class="fas fa-car"></i>
                                </div>
                                <div class="document-info">
                                    <h4>CRLV</h4>
                                    <p class="document-status" id="crlv-status">Não enviado</p>
                                    <p class="document-date" id="crlv-date"></p>
                                </div>
                                <div class="document-actions">
                                    <button class="btn-icon view-doc" id="view-crlv" style="display: none;">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon upload-doc" id="upload-crlv">
                                        <i class="fas fa-upload"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="document-card" data-doc-type="antecedentes">
                                <div class="document-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="document-info">
                                    <h4>Antecedentes Criminais</h4>
                                    <p class="document-status" id="antecedentes-status">Não enviado</p>
                                    <p class="document-date" id="antecedentes-date"></p>
                                </div>
                                <div class="document-actions">
                                    <button class="btn-icon view-doc" id="view-antecedentes" style="display: none;">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon upload-doc" id="upload-antecedentes">
                                        <i class="fas fa-upload"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Controle de Viagens -->
            <div class="tab-content" id="trips-tab">
                <div class="trip-status-card">
                    <div class="trip-status-header">
                        <div class="status-indicator">
                            <span class="status-dot" id="trip-status-dot"></span>
                            <span class="status-text" id="trip-status-text">Nenhuma viagem ativa</span>
                        </div>
                        <div>
                            <button class="btn btn-success" id="start-trip">
                                <i class="fas fa-play"></i>
                                Iniciar Viagem
                            </button>
                            <button class="btn btn-danger" id="end-trip" style="display: none;">
                                <i class="fas fa-stop"></i>
                                Finalizar Viagem
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Container para detalhes da viagem -->
                <div id="viagem-detalhes" class="viagem-detalhes-container" style="margin: 1rem 0;"></div>

                <div class="children-list" id="children-list" style="display: none;">
                    <h3 style="margin-bottom: 1rem;">
                        <i class="fas fa-users"></i>
                        Crianças da Rota
                    </h3>
                    <div class="children-grid" id="children-grid">
                        <!-- Lista de crianças será carregada dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Tab: Gerenciar Rotas -->
            <div class="tab-content" id="routes-tab">
                <!-- Header com estatísticas do plano -->
                <div class="plan-status-card" id="plan-status-card">
                    <div class="plan-info">
                        <h3 id="plan-name">Carregando plano...</h3>
                        <p id="plan-description">Verificando informações do plano</p>
                    </div>
                    <div class="plan-usage">
                        <div class="usage-item">
                            <span class="usage-label">Rotas:</span>
                            <span class="usage-value" id="routes-usage">0/0</span>
                        </div>
                        <div class="usage-item">
                            <span class="usage-label">Crianças:</span>
                            <span class="usage-value" id="children-usage">0/0</span>
                        </div>
                    </div>
                    <button class="btn btn-outline" id="upgrade-plan-btn" style="display: none;">
                        <i class="fas fa-arrow-up"></i>
                        Fazer Upgrade
                    </button>
                </div>

                <!-- Ações principais -->
                <div class="routes-actions">
                    <button class="btn btn-primary" id="create-route-btn">
                        <i class="fas fa-plus"></i>
                        Criar Nova Rota
                    </button>
                    <button class="btn btn-blue" id="view-routes-btn">
                        <i class="fas fa-list"></i>
                        Ver Rotas Existentes
                    </button>
                    <button class="btn btn-success" id="view-interests-btn">
                        <i class="fas fa-heart"></i>
                        Interesses Recebidos
                        <span class="badge" id="interests-count" style="display: none;">0</span>
                    </button>
                </div>

                <!-- Lista de rotas -->
                <div class="routes-container">
                    <div class="routes-header">
                        <h3>Suas Rotas Escolares</h3>
                        <div class="routes-filters">
                            <select id="route-status-filter">
                                <option value="">Todos os status</option>
                                <option value="ativa">Ativas</option>
                                <option value="inativa">Inativas</option>
                                <option value="pausada">Pausadas</option>
                            </select>
                            <select id="route-type-filter">
                                <option value="">Todos os tipos</option>
                                <option value="ida">Ida</option>
                                <option value="volta">Volta</option>
                                <option value="ida_volta">Ida e Volta</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="routes-list" class="routes-grid">
                        <!-- Rotas serão carregadas dinamicamente -->
                        <div class="empty-state" id="routes-empty-state">
                            <i class="fas fa-route"></i>
                            <h4>Nenhuma rota cadastrada</h4>
                            <p>Comece criando sua primeira rota escolar</p>
                            <button class="btn btn-primary" onclick="document.getElementById('create-route-btn').click()">
                                <i class="fas fa-plus"></i>
                                Criar Primeira Rota
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Estatísticas rápidas -->
                <div class="routes-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-route"></i>
                        </div>
                        <div class="stat-content">
                            <h4 id="total-routes">0</h4>
                            <p>Total de Rotas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h4 id="total-children-routes">0</h4>
                            <p>Crianças Atendidas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="stat-content">
                            <h4 id="total-interests">0</h4>
                            <p>Interesses Recebidos</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h4 id="average-rating">0.0</h4>
                            <p>Avaliação Média</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Rastreamento -->
            <div class="tab-content" id="tracking-tab">
                <div class="report-filters">
                    <div class="filter-group">
                        <label for="tracking-period">Período:</label>
                        <select id="tracking-period">
                            <option value="daily">Diário</option>
                            <option value="weekly">Semanal</option>
                            <option value="monthly">Mensal</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="tracking-date">Data:</label>
                        <input type="date" id="tracking-date">
                    </div>
                    <div class="filter-group">
                        <button class="btn btn-primary" id="load-tracking-report">
                            <i class="fas fa-search"></i>
                            Buscar
                        </button>
                    </div>
                </div>

                <div class="report-cards">
                    <div class="report-card">
                        <div class="report-icon trips">
                            <i class="fas fa-route"></i>
                        </div>
                        <div class="report-content">
                            <h4>Total de Viagens</h4>
                            <div class="report-value" id="tracking-trips">0</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon distance">
                            <i class="fas fa-road"></i>
                        </div>
                        <div class="report-content">
                            <h4>Distância Percorrida</h4>
                            <div class="report-value" id="tracking-distance">0 km</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon fuel">
                            <i class="fas fa-gas-pump"></i>
                        </div>
                        <div class="report-content">
                            <h4>Combustível Gasto</h4>
                            <div class="report-value" id="tracking-fuel">0 L</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon children">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="report-content">
                            <h4>Crianças Transportadas</h4>
                            <div class="report-value" id="tracking-children">0</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Histórico de Rastreamento</h3>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="tracking-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tab: Relatórios -->
            <div class="tab-content" id="reports-tab">
                <div class="report-table">
                    <div class="table-header">
                        <h3 class="table-title">Histórico de Viagens</h3>
                    </div>
                    <table id="trips-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Horário</th>
                                <th>Rota</th>
                                <th>Distância</th>
                                <th>Combustível</th>
                                <th>Crianças</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="trips-tbody">
                            <!-- Dados serão carregados dinamicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab: Financeiro -->
            <div class="tab-content" id="financial-tab">
                <div class="report-cards">
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(40, 167, 69, 0.1); color: var(--success-color);">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="report-content">
                            <h4>Receita Mensal</h4>
                            <div class="report-value" id="financial-revenue">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(220, 53, 69, 0.1); color: var(--danger-color);">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="report-content">
                            <h4>Custos Operacionais</h4>
                            <div class="report-value" id="financial-costs">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(0, 123, 255, 0.1); color: var(--primary-color);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="report-content">
                            <h4>Lucro Líquido</h4>
                            <div class="report-value" id="financial-profit">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(255, 193, 7, 0.1); color: var(--warning-color);">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="report-content">
                            <h4>Margem de Lucro</h4>
                            <div class="report-value" id="financial-margin">0%</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Evolução Financeira</h3>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="financial-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificação -->
    <div id="notification" class="notification">
        <span id="notification-message"></span>
    </div>

    <!-- Modal de Cadastro de Rotas Escolares -->
    <div id="route-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-route"></i>
                    <span id="modal-title">Criar Nova Rota Escolar</span>
                </h2>
                <button class="close-modal" id="close-route-modal">&times;</button>
            </div>
            
            <form id="route-form" class="route-form">
                <!-- Informações Básicas -->
                <div class="form-section">
                    <h3><i class="fas fa-info-circle"></i> Informações Básicas</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="route-name">Nome da Rota *</label>
                            <input type="text" id="route-name" name="route-name" placeholder="Ex: Rota Manhã - Centro" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-period">Período *</label>
                            <select id="route-period" name="route-period" required>
                                <option value="">Selecione o período</option>
                                <option value="manha">Manhã</option>
                                <option value="tarde">Tarde</option>
                                <option value="noite">Noite</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-type">Tipo de Rota *</label>
                            <select id="route-type" name="route-type" required>
                                <option value="">Selecione o tipo</option>
                                <option value="ida">Apenas Ida (Casa → Escola)</option>
                                <option value="volta">Apenas Volta (Escola → Casa)</option>
                                <option value="ida-volta">Ida e Volta</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="route-capacity">Capacidade de Crianças *</label>
                            <input type="number" id="route-capacity" name="route-capacity" min="1" max="50" placeholder="Ex: 20" required>
                            <small>Número máximo de crianças que podem ser atendidas nesta rota</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-price">Valor Mensal (R$) *</label>
                            <input type="number" id="route-price" name="route-price" min="0" step="0.01" placeholder="Ex: 150.00" required>
                            <small>Valor cobrado por criança por mês</small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Dias da Semana *</label>
                        <div class="days-grid">
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="segunda">
                                <span>Segunda</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="terca">
                                <span>Terça</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="quarta">
                                <span>Quarta</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="quinta">
                                <span>Quinta</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="sexta">
                                <span>Sexta</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="sabado">
                                <span>Sábado</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Horários -->
                <div class="form-section">
                    <h3><i class="fas fa-clock"></i> Horários</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="route-start-time">Horário de Início *</label>
                            <input type="time" id="route-start-time" name="route-start-time" required>
                            <small>Horário da primeira parada</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-end-time">Horário de Término *</label>
                            <input type="time" id="route-end-time" name="route-end-time" required>
                            <small>Horário estimado da última parada</small>
                        </div>
                    </div>
                </div>

                <!-- Localização -->
                <div class="form-section">
                    <h3><i class="fas fa-map-marker-alt"></i> Localização</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="route-origin">Ponto de Origem *</label>
                            <input type="text" id="route-origin" name="route-origin" placeholder="Endereço de onde a rota inicia" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-destination">Destino (Escola) *</label>
                            <input type="text" id="route-destination" name="route-destination" placeholder="Nome e endereço da escola" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="route-coverage">Área de Cobertura</label>
                        <textarea id="route-coverage" name="route-coverage" rows="2" placeholder="Descreva os bairros ou regiões atendidas por esta rota..."></textarea>
                    </div>
                </div>

                <!-- Observações -->
                <div class="form-section">
                    <h3><i class="fas fa-sticky-note"></i> Informações Adicionais</h3>
                    <div class="form-group">
                        <label for="route-observations">Observações</label>
                        <textarea id="route-observations" name="route-observations" rows="3" placeholder="Informações importantes sobre a rota, requisitos especiais, etc..."></textarea>
                    </div>
                </div>

                <!-- Botões -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-route-btn">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        <span id="save-btn-text">Salvar Rota</span>
                    </button>
                </div>

         function saveRoute() {
             const formData = new FormData(document.getElementById('route-form'));
             const routeData = {
                 name: formData.get('route-name'),
                 period: formData.get('route-period'),
                 type: formData.get('route-type'),
                 days: formData.getAll('days'),
                 capacity: formData.get('route-capacity'),
                 monthlyValue: formData.get('route-monthly-value'),
                 startTime: formData.get('route-start-time'),
                 endTime: formData.get('route-end-time'),
                 origin: formData.get('route-origin'),
                 destination: formData.get('route-destination'),
                 coverageArea: formData.get('route-coverage-area'),
                 observations: formData.get('route-observations')
             };

             // Validações
             if (!routeData.name || !routeData.period || !routeData.type) {
                 showNotification('Por favor, preencha todos os campos obrigatórios.', 'warning');
                 return;
             }

             if (routeData.days.length === 0) {
                 showNotification('Selecione pelo menos um dia da semana.', 'warning');
                 return;
             }

             // Simular salvamento
             currentRoutes.push({
                 id: Date.now(),
                 name: routeData.name,
                 period: routeData.period,
                 type: routeData.type,
                 capacity: routeData.capacity,
                 monthlyValue: routeData.monthlyValue,
                 startTime: routeData.startTime,
                 endTime: routeData.endTime,
                 origin: routeData.origin,
                 destination: routeData.destination,
                 coverageArea: routeData.coverageArea,
                 observations: routeData.observations,
                 days: routeData.days,
                 active: true
             });

             showNotification('Rota salva com sucesso!', 'success');
             closeModal(document.getElementById('route-modal'));
             loadRoutesOverview();
         }

         function loadRoutesList() {
             const routesList = document.getElementById('routes-list');
             
             if (currentRoutes.length === 0) {
                 routesList.innerHTML = '<p style="text-align: center; color: var(--secondary-color);">Nenhuma rota cadastrada ainda.</p>';
                 return;
             }

             routesList.innerHTML = currentRoutes.map(route => `
                 <div style="background: var(--white); border: 1px solid var(--border-color); border-radius: var(--border-radius); padding: 1rem; margin-bottom: 1rem;">
                     <h4 style="margin: 0 0 0.5rem 0;">${route.name}</h4>
                     <p style="margin: 0; color: var(--secondary-color); font-size: 0.9rem;">
                         ${route.period} • ${route.type} • Capacidade: ${route.capacity || 'N/A'} crianças
                     </p>
                     <p style="margin: 0.25rem 0 0 0; color: var(--secondary-color); font-size: 0.9rem;">
                         ${route.origin || 'N/A'} → ${route.destination || 'N/A'}
                     </p>
                     <div style="margin-top: 0.5rem;">
                         <span style="padding: 2px 8px; background: ${route.active ? 'var(--success-color)' : 'var(--danger-color)'}; color: white; border-radius: 12px; font-size: 0.8rem;">
                             ${route.active ? 'Ativa' : 'Inativa'}
                         </span>
                     </div>
                 </div>
             `).join('');
         }

         // Funções de gráficos
         function initializeCharts() {
             // Inicializar gráficos vazios
             updateDashboardChart();
             updateTrackingChart();
             updateFinancialChart();
         }

         function updateDashboardChart() {
             const ctx = document.getElementById('dashboard-chart');
             if (!ctx) return;

             if (charts.dashboard) {
                 charts.dashboard.destroy();
             }

             charts.dashboard = new Chart(ctx, {
                 type: 'line',
                 data: {
                     labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                     datasets: [{
                         label: 'Viagens',
                         data: [12, 19, 8, 15, 22, 18, 14],
                         borderColor: 'var(--primary-color)',
                         backgroundColor: 'rgba(0, 123, 255, 0.1)',
                         tension: 0.4
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             display: false
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateTrackingChart() {
             const ctx = document.getElementById('tracking-chart');
             if (!ctx) return;

             if (charts.tracking) {
                 charts.tracking.destroy();
             }

             charts.tracking = new Chart(ctx, {
                 type: 'bar',
                 data: {
                     labels: ['01/10', '02/10', '03/10', '04/10', '05/10'],
                     datasets: [{
                         label: 'Distância (km)',
                         data: [25, 30, 22, 28, 35],
                         backgroundColor: 'var(--success-color)'
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             display: false
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateFinancialChart() {
             const ctx = document.getElementById('financial-chart');
             if (!ctx) return;

             if (charts.financial) {
                 charts.financial.destroy();
             }

             charts.financial = new Chart(ctx, {
                 type: 'line',
                 data: {
                     labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                     datasets: [{
                         label: 'Receita',
                         data: [2500, 2800, 3200, 2900, 3500, 4250],
                         borderColor: 'var(--success-color)',
                         backgroundColor: 'rgba(40, 167, 69, 0.1)',
                         tension: 0.4
                     }, {
                         label: 'Custos',
                         data: [1800, 2000, 2200, 2100, 2400, 1890],
                         borderColor: 'var(--danger-color)',
                         backgroundColor: 'rgba(220, 53, 69, 0.1)',
                         tension: 0.4
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             position: 'top'
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateChartsTheme() {
             // Atualizar cores dos gráficos baseado no tema
             Object.values(charts).forEach(chart => {
                 if (chart) {
                     chart.update();
                 }
             });
         }

         function showNotification(message, type = 'info') {
             const notification = document.getElementById('notification');
             const messageElement = document.getElementById('notification-message');
             
             messageElement.textContent = message;
             notification.className = `notification ${type}`;
             notification.classList.add('show');

             setTimeout(() => {
                 notification.classList.remove('show');
             }, 3000);
         }

         // Tornar funções globais para uso nos botões
         window.checkIn = checkIn;
         window.checkOut = checkOut;
         window.removeStop = removeStop;
     </script>
</body>
</html> required>
                                </div>
                                <div class="form-group">
                                    <label>Horário *</label>
                                    <input type="time" name="stop-time" required>
                                </div>
                                <div class="form-group">
                                    <label>Ponto de Referência</label>
                                    <input type="text" name="stop-reference" placeholder="Ex: Próximo ao supermercado">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Crianças nesta parada</label>
                                <select name="stop-children" multiple style="height: 100px;">
                                    <!-- Opções serão carregadas dinamicamente -->
                                </select>
                                <small style="color: var(--secondary-color); margin-top: 0.25rem;">Segure Ctrl para selecionar múltiplas crianças</small>
                            </div>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-blue" id="add-stop-btn">
                        <i class="fas fa-plus"></i>
                        Adicionar Parada
                    </button>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                    <button type="button" class="btn" style="background: var(--secondary-color); color: white;" id="cancel-route-btn">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        Salvar Rota
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Visualização de Rotas -->
    <div id="routes-list-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-list"></i>
                    Rotas Cadastradas
                </h2>
                <button class="close-modal" id="close-routes-list-modal">&times;</button>
            </div>
            
            <div class="routes-list" id="routes-list" style="padding: 1.5rem;">
                <!-- Lista de rotas será carregada dinamicamente -->
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let currentTrip = null;
        let charts = {};
        let isDarkTheme = localStorage.getItem('theme') === 'dark' || false;
        let token = localStorage.getItem('authToken');

        // Variáveis para rotas
        let currentRoutes = [];



        // Função para verificar token continuamente
        async function continuousTokenCheck() {
            const currentToken = localStorage.getItem('authToken');
            
            if (!currentToken) {
                console.log('Token removido, redirecionando para login');
                window.location.href = 'login.html';
                return false;
            }

            try {
                const response = await fetch('/api/validate-token', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${currentToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    console.log('Token inválido durante verificação contínua');
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html';
                    return false;
                }

                const data = await response.json();
                
                if (!data.valid || data.user.tipo !== 'motorista_escolar') {
                    console.log('Usuário não autorizado durante verificação contínua');
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html';
                    return false;
                }

                return true;
                
            } catch (error) {
                console.log('Erro na verificação contínua de token:', error);
                localStorage.removeItem('authToken');
                window.location.href = 'login.html';
                return false;
            }
        }

        // Detectar navegação pelo botão voltar/avançar
        window.addEventListener('pageshow', function(event) {
            // Se a página foi carregada do cache (botão voltar)
            if (event.persisted) {
                console.log('Página carregada do cache, verificando autenticação');
                continuousTokenCheck();
            }
        });

        // Verificar token quando a página ganha foco
        window.addEventListener('focus', function() {
            console.log('Página ganhou foco, verificando autenticação');
            continuousTokenCheck();
        });

        // Verificar token quando a página se torna visível
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                console.log('Página se tornou visível, verificando autenticação');
                continuousTokenCheck();
            }
        });

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Aplicar tema salvo
            if (isDarkTheme) {
                document.body.classList.add('dark-theme');
            }
            
            // Configurar event listeners
            setupEventListeners();
            
            // Inicializar aplicação
            initializeApp();
            loadUserData();
            // loadDashboardData(); // Comentado temporariamente para teste das abas
            // setupRouteEventListeners(); // Comentado temporariamente para teste das abas
            
            // Mostrar primeira aba por padrão
            switchTab('dashboard');

            // Iniciar verificação periódica de token (a cada 30 segundos)
            setInterval(continuousTokenCheck, 30000);
        });

        async function initializeApp() {
            // Verificar tema salvo
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }

            // Verificar autenticação
            if (!token) {
                console.log('Token não encontrado, redirecionando para login');
                window.location.href = 'login.html';
                return;
            }

            // Validar token com o servidor
            try {
                const response = await fetch('/api/validate-token', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    console.log('Token inválido, redirecionando para login');
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html';
                    return;
                }

                const data = await response.json();
                
                // Verificar se o usuário tem permissão para esta área
                if (data.user.tipo !== 'motorista_escolar') {
                    console.log('Usuário não tem permissão para esta área');
                    alert('Você não tem permissão para acessar esta área.');
                    window.location.href = 'login.html';
                    return;
                }

                console.log('Usuário autenticado:', data.user.nome);
                
            } catch (error) {
                console.log('Erro ao validar token:', error);
                localStorage.removeItem('authToken');
                window.location.href = 'login.html';
                return;
            }

            // Inicializar gráficos (comentado temporariamente para teste das abas)
            // initializeCharts();
        }

        function setupEventListeners() {
            // Navegação por abas
            const tabButtons = document.querySelectorAll('.tab-button');
            
            tabButtons.forEach((button) => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });

            // Toggle de tema
            const themeToggle = document.getElementById('theme-toggle');
            
            if (themeToggle) {
                themeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    toggleTheme();
                });
            }

            // Controle de viagem
            document.getElementById('start-trip').addEventListener('click', startTrip);
            document.getElementById('end-trip').addEventListener('click', endTrip);

            // Atualizar dashboard
            document.getElementById('refresh-dashboard').addEventListener('click', function() {
                this.classList.add('loading');
                loadDashboardData();
                setTimeout(() => this.classList.remove('loading'), 1000);
            });

            // Relatórios de rastreamento
            document.getElementById('load-tracking-report').addEventListener('click', loadTrackingReport);

            // Logout
            document.getElementById('logout-button').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('Tem certeza que deseja sair?')) {
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html';
                }
            });
        }

        function setupRouteEventListeners() {
            // Elementos do DOM para rotas
            const routeModal = document.getElementById('route-modal');
            const routesListModal = document.getElementById('routes-list-modal');
            const createRouteBtn = document.getElementById('create-route-btn');
            const viewRoutesBtn = document.getElementById('view-routes-btn');
            const routeForm = document.getElementById('route-form');

            // Event Listeners para abrir modais
            createRouteBtn?.addEventListener('click', openRouteModal);
            viewRoutesBtn?.addEventListener('click', openRoutesListModal);

            // Event Listeners para fechar modais
            document.getElementById('close-route-modal')?.addEventListener('click', () => {
                closeModal(routeModal);
            });

            document.getElementById('close-routes-list-modal')?.addEventListener('click', () => {
                closeModal(routesListModal);
            });

            document.getElementById('cancel-route-btn')?.addEventListener('click', () => {
                closeModal(routeModal);
            });

            // Fechar modal ao clicar fora
            routeModal?.addEventListener('click', (e) => {
                if (e.target === routeModal) {
                    closeModal(routeModal);
                }
            });

            routesListModal?.addEventListener('click', (e) => {
                if (e.target === routesListModal) {
                    closeModal(routesListModal);
                }
            });



            // Event Listener para submissão do formulário
            routeForm?.addEventListener('submit', (e) => {
                e.preventDefault();
                saveRoute();
            });
        }

        function switchTab(tabId) {
            // Remover classe active de todos os botões e conteúdos
            const allButtons = document.querySelectorAll('.tab-button');
            const allContents = document.querySelectorAll('.tab-content');
            
            allButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            allContents.forEach(content => {
                content.classList.remove('active');
            });

            // Adicionar classe active ao botão e conteúdo selecionados
            const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
            const tabContent = document.getElementById(`${tabId}-tab`);
            
            if (tabButton) {
                tabButton.classList.add('active');
            }
            
            if (tabContent) {
                tabContent.classList.add('active');
            }

            // Carregar dados específicos da aba se necessário
            if (tabId === 'tracking') {
                loadTrackingReport();
            } else if (tabId === 'reports') {
                loadReportsData();
            } else if (tabId === 'financial') {
                loadFinancialData();
            } else if (tabId === 'routes') {
                loadRoutesOverview();
            }
        }

        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            const body = document.body;
            const themeIcon = document.querySelector('#theme-toggle i');

            if (isDarkTheme) {
                body.classList.add('dark-theme');
                body.setAttribute('data-theme', 'dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-sun';
                }
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark-theme');
                body.removeAttribute('data-theme');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-moon';
                }
                localStorage.setItem('theme', 'light');
            }

            // Atualizar gráficos com novo tema
            if (typeof updateChartsTheme === 'function') {
                updateChartsTheme();
            }
            
            // Mostrar notificação
            showNotification(`Tema ${isDarkTheme ? 'escuro' : 'claro'} ativado!`, 'info');
        }

        function loadUserData() {
            // Simular carregamento de dados do usuário
            // Em produção, fazer requisição para API
        }

        function loadDashboardData() {
            // Simular dados do dashboard
            document.getElementById('trips-today').textContent = '8';
            document.getElementById('trips-change').textContent = '+12% vs ontem';
            
            document.getElementById('monthly-revenue').textContent = 'R$ 4.250';
            document.getElementById('revenue-change').textContent = '+8% vs mês anterior';
            
            document.getElementById('active-children').textContent = '24';
            document.getElementById('children-change').textContent = '+2 novos';
            
            document.getElementById('total-distance').textContent = '156 km';
            document.getElementById('distance-change').textContent = '+23 km hoje';

            // Atualizar gráfico do dashboard
            updateDashboardChart();
        }

        function loadTrackingReport() {
            const period = document.getElementById('tracking-period').value;
            const date = document.getElementById('tracking-date').value;

            // Simular dados de rastreamento
            document.getElementById('tracking-trips').textContent = '12';
            document.getElementById('tracking-distance').textContent = '245 km';
            document.getElementById('tracking-fuel').textContent = '28 L';
            document.getElementById('tracking-children').textContent = '36';

            updateTrackingChart();
        }

        function loadReportsData() {
            // Simular dados de relatórios
            const tbody = document.getElementById('trips-tbody');
            tbody.innerHTML = `
                <tr>
                    <td>18/10/2024</td>
                    <td>07:30</td>
                    <td>Rota Manhã - Centro</td>
                    <td>15.2 km</td>
                    <td>2.1 L</td>
                    <td>8</td>
                    <td><span style="color: var(--success-color);">Concluída</span></td>
                </tr>
                <tr>
                    <td>18/10/2024</td>
                    <td>12:00</td>
                    <td>Rota Tarde - Bairro Norte</td>
                    <td>18.7 km</td>
                    <td>2.5 L</td>
                    <td>12</td>
                    <td><span style="color: var(--success-color);">Concluída</span></td>
                </tr>
            `;
        }

        function loadFinancialData() {
            // Simular dados financeiros
            document.getElementById('financial-revenue').textContent = 'R$ 4.250,00';
            document.getElementById('financial-costs').textContent = 'R$ 1.890,00';
            document.getElementById('financial-profit').textContent = 'R$ 2.360,00';
            document.getElementById('financial-margin').textContent = '55.5%';

            updateFinancialChart();
        }

        function loadRoutesOverview() {
            // Carregar overview das rotas
            const overview = document.getElementById('routes-overview');
            
            if (currentRoutes.length === 0) {
                overview.innerHTML = `
                    <p style="text-align: center; color: var(--secondary-color); padding: 2rem;">
                        <i class="fas fa-route" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                        Nenhuma rota cadastrada ainda. Clique em "Criar Nova Rota" para começar.
                    </p>
                `;
            } else {
                // Mostrar resumo das rotas
                overview.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        ${currentRoutes.map(route => `
                            <div style="background: var(--light-color); padding: 1rem; border-radius: var(--border-radius); border-left: 4px solid var(--primary-color);">
                                <h4 style="margin: 0 0 0.5rem 0;">${route.name}</h4>
                                <p style="margin: 0; color: var(--secondary-color); font-size: 0.9rem;">
                                    ${route.period} • ${route.type} • ${route.stops.length} paradas
                                </p>
                                <div style="margin-top: 0.5rem;">
                                    <span style="padding: 2px 8px; background: ${route.active ? 'var(--success-color)' : 'var(--danger-color)'}; color: white; border-radius: 12px; font-size: 0.8rem;">
                                        ${route.active ? 'Ativa' : 'Inativa'}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        function startTrip() {
            const statusDot = document.getElementById('trip-status-dot');
            const statusText = document.getElementById('trip-status-text');
            const startBtn = document.getElementById('start-trip');
            const endBtn = document.getElementById('end-trip');
            const childrenList = document.getElementById('children-list');

            // Simular início de viagem
            currentTrip = {
                id: Date.now(),
                startTime: new Date(),
                children: [
                    { id: 1, name: 'Ana Silva', address: 'Rua A, 123', status: 'waiting' },
                    { id: 2, name: 'João Santos', address: 'Rua B, 456', status: 'waiting' },
                    { id: 3, name: 'Maria Oliveira', address: 'Rua C, 789', status: 'waiting' }
                ]
            };

            statusDot.classList.add('active');
            statusText.textContent = 'Viagem em andamento';
            startBtn.style.display = 'none';
            endBtn.style.display = 'inline-flex';
            childrenList.style.display = 'block';

            loadChildrenList();
            showNotification('Viagem iniciada com sucesso!', 'success');
        }

        function endTrip() {
            const statusDot = document.getElementById('trip-status-dot');
            const statusText = document.getElementById('trip-status-text');
            const startBtn = document.getElementById('start-trip');
            const endBtn = document.getElementById('end-trip');
            const childrenList = document.getElementById('children-list');

            if (confirm('Tem certeza que deseja finalizar a viagem?')) {
                currentTrip = null;
                
                statusDot.classList.remove('active');
                statusText.textContent = 'Nenhuma viagem ativa';
                startBtn.style.display = 'inline-flex';
                endBtn.style.display = 'none';
                childrenList.style.display = 'none';

                showNotification('Viagem finalizada com sucesso!', 'success');
            }
        }

        function loadChildrenList() {
            const grid = document.getElementById('children-grid');
            
            if (!currentTrip) return;

            grid.innerHTML = currentTrip.children.map(child => `
                <div class="child-card ${child.status === 'checked-in' ? 'checked-in' : child.status === 'checked-out' ? 'checked-out' : ''}">
                    <div class="child-info">
                        <div class="child-name">${child.name}</div>
                        <div class="child-details">${child.address}</div>
                    </div>
                    <div class="child-actions">
                        <button class="btn btn-success" onclick="checkIn(${child.id})" ${child.status === 'checked-in' ? 'disabled' : ''}>
                            <i class="fas fa-sign-in-alt"></i>
                            Check-in
                        </button>
                        <button class="btn btn-danger" onclick="checkOut(${child.id})" ${child.status !== 'checked-in' ? 'disabled' : ''}>
                            <i class="fas fa-sign-out-alt"></i>
                            Check-out
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function checkIn(childId) {
            if (!currentTrip) return;
            
            const child = currentTrip.children.find(c => c.id === childId);
            if (child) {
                child.status = 'checked-in';
                loadChildrenList();
                showNotification(`${child.name} fez check-in!`, 'success');
            }
        }

        function checkOut(childId) {
            if (!currentTrip) return;
            
            const child = currentTrip.children.find(c => c.id === childId);
            if (child) {
                child.status = 'checked-out';
                loadChildrenList();
                showNotification(`${child.name} fez check-out!`, 'info');
            }
        }

        // Funções para rotas
        function openRouteModal() {
            resetRouteForm();
            document.getElementById('route-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function openRoutesListModal() {
            loadRoutesList();
            document.getElementById('routes-list-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        function resetRouteForm() {
            document.getElementById('route-form').reset();
        }
    </script>
    
    <!-- Script para forçar tema claro -->
    <script>
        // Força o tema claro para garantir visibilidade adequada
        document.documentElement.setAttribute('data-theme', 'light');
        document.body.classList.remove('dark-theme');
        document.body.classList.add('light-theme');
    </script>
</body>
</html>