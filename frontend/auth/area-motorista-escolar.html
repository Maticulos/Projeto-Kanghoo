<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Área do Motorista - Kanghoo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/font-awesome.min.css">
    <script src="../js/chart.min.js"></script>
    <script src="../js/rastreamento-api.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --white: #ffffff;
            --border-color: #e9ecef;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.15);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #0dcaf0;
            --light-color: #212529;
            --dark-color: #f8f9fa;
            --white: #1a1a1a;
            --border-color: #495057;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            transition: var(--transition);
        }

        /* Header Melhorado */
        .header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--light-color);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--dark-color);
            font-size: 1.2rem;
            position: relative;
            overflow: hidden;
        }

        .theme-toggle:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background: var(--white);
            transform: scale(1.1);
            box-shadow: var(--shadow);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        [data-theme="dark"] .theme-toggle {
            background: var(--dark-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* Container Principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Dashboard Overview */
        .dashboard-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .dashboard-card.success {
            border-left-color: var(--success-color);
        }

        .dashboard-card.warning {
            border-left-color: var(--warning-color);
        }

        .dashboard-card.danger {
            border-left-color: var(--danger-color);
        }

        .dashboard-card.info {
            border-left-color: var(--info-color);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-weight: 500;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light-color);
            color: var(--primary-color);
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .card-change {
            font-size: 0.8rem;
            font-weight: 500;
        }

        .card-change.positive {
            color: var(--success-color);
        }

        .card-change.negative {
            color: var(--danger-color);
        }

        /* Tabs Container */
        .tabs-container {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .tabs-nav {
            display: flex;
            background: var(--light-color);
            overflow-x: auto;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--secondary-color);
            transition: var(--transition);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 3px solid transparent;
            position: relative;
            min-width: 120px;
            justify-content: center;
            font-size: 0.9rem;
        }

        .tab-button.active {
            color: var(--primary-color);
            background: var(--white);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
            box-shadow: 0 -2px 8px rgba(0, 123, 255, 0.1);
        }

        .tab-button:hover:not(.active) {
            background: rgba(0, 123, 255, 0.1);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .tab-button i {
            font-size: 1rem;
        }

        .tab-content {
            padding: 2rem;
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Botões */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #1e7e34;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .btn-blue {
            background: var(--info-color);
            color: white;
        }

        .btn-blue:hover {
            background: #138496;
            transform: translateY(-1px);
        }

        .btn-logout {
            background: var(--danger-color);
            color: white;
            padding: 0.5rem 1rem;
        }

        .btn-logout:hover {
            background: #c82333;
        }

        /* Status de Viagem */
        .trip-status-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .trip-status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--danger-color);
        }

        .status-dot.active {
            background: var(--success-color);
            animation: pulse 2s infinite;
        }

        /* Detalhes da Viagem */
        .viagem-detalhes-container {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
        }

        .viagem-info h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .viagem-info p {
            margin: 0.5rem 0;
            color: var(--dark-color);
        }

        .viagem-info strong {
            color: var(--secondary-color);
            font-weight: 600;
        }

        .dados-simulados-info {
            background: rgba(23, 162, 184, 0.1);
            border: 1px solid var(--info-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-top: 1rem;
        }

        .dados-simulados-info i {
            margin-right: 0.5rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .status-text {
            font-weight: 500;
            color: var(--dark-color);
        }

        /* Lista de Crianças */
        .children-list {
            margin-top: 2rem;
        }

        .children-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .child-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .child-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .child-card.checked-in {
            border-left: 4px solid var(--success-color);
        }

        .child-card.checked-out {
            border-left: 4px solid var(--secondary-color);
        }

        .child-info {
            margin-bottom: 1rem;
        }

        .child-name {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .child-details {
            font-size: 0.9rem;
            color: var(--secondary-color);
        }

        .child-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Gráficos */
        .chart-container {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .chart-canvas {
            position: relative;
            height: 300px;
        }

        /* Relatórios */
        .report-filters {
            display: flex;
            gap: 1rem;
            align-items: end;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-group label {
            font-weight: 500;
            color: var(--dark-color);
        }

        .filter-group select,
        .filter-group input {
            padding: 0.5rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background: var(--white);
            color: var(--dark-color);
            transition: var(--transition);
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .report-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .report-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .report-icon.trips {
            background: rgba(0, 123, 255, 0.1);
            color: var(--primary-color);
        }

        .report-icon.distance {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }

        .report-icon.fuel {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning-color);
        }

        .report-icon.children {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .report-content h4 {
            margin: 0;
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .report-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-color);
        }

        /* Tabelas */
        .report-table {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            background: var(--light-color);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .table-title {
            font-weight: 600;
            color: var(--dark-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--light-color);
            font-weight: 600;
            color: var(--dark-color);
        }

        td {
            color: var(--secondary-color);
        }

        /* Modal de Rotas */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
            margin: 0;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-color);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--danger-color);
        }

        .route-form {
            padding: 1.5rem;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--light-color);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }

        .form-section h3 {
            margin: 0 0 1rem 0;
            color: var(--dark-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.9rem;
            transition: var(--transition);
            background: var(--white);
            color: var(--dark-color);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
            }

            .dashboard-overview {
                grid-template-columns: 1fr;
            }

            .tabs-nav {
                flex-direction: column;
            }

            .tab-button {
                justify-content: center;
            }

            .trip-status-header {
                flex-direction: column;
                align-items: stretch;
            }

            .children-grid {
                grid-template-columns: 1fr;
            }

            .report-filters {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                width: 100%;
            }

            .report-cards {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animações */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Estados de loading */
        .loading {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notificações */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 500;
            z-index: 10000;
            transform: translateX(400px);
            transition: var(--transition);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--danger-color);
        }

        .notification.warning {
            background: var(--warning-color);
        }

        .notification.info {
            background: var(--info-color);
        }
    </style>
</head>
<body>
    <!-- Header Melhorado -->
    <header class="header">
        <div class="header-container">
            <a href="../public/index.html" class="logo">
                <i class="fas fa-bus"></i>
                <span>Kanghoo</span>
            </a>
            
            <div class="header-actions">
                <button id="logout-button" class="btn btn-logout" title="Sair do sistema">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </button>
                <button class="theme-toggle" id="theme-toggle" title="Alternar tema">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Container Principal -->
    <div class="container">
        <!-- Dashboard Overview -->
        <div class="dashboard-overview fade-in">
            <div class="dashboard-card success">
                <div class="card-header">
                    <div class="card-title">Viagens Hoje</div>
                    <div class="card-icon">
                        <i class="fas fa-route"></i>
                    </div>
                </div>
                <div class="card-value" id="trips-today">0</div>
                <div class="card-change positive" id="trips-change">+0% vs ontem</div>
            </div>

            <div class="dashboard-card warning">
                <div class="card-header">
                    <div class="card-title">Receita Mensal</div>
                    <div class="card-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                </div>
                <div class="card-value" id="monthly-revenue">R$ 0</div>
                <div class="card-change positive" id="revenue-change">+0% vs mês anterior</div>
            </div>

            <div class="dashboard-card info">
                <div class="card-header">
                    <div class="card-title">Crianças Ativas</div>
                    <div class="card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="card-value" id="active-children">0</div>
                <div class="card-change positive" id="children-change">+0 novos</div>
            </div>

            <div class="dashboard-card danger">
                <div class="card-header">
                    <div class="card-title">Distância Total</div>
                    <div class="card-icon">
                        <i class="fas fa-road"></i>
                    </div>
                </div>
                <div class="card-value" id="total-distance">0 km</div>
                <div class="card-change positive" id="distance-change">+0 km hoje</div>
            </div>
        </div>

        <!-- Tabs Container -->
        <div class="tabs-container fade-in">
            <div class="tabs-nav">
                <button class="tab-button active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                </button>
                <button class="tab-button" data-tab="trips">
                    <i class="fas fa-route"></i>
                    Controle de Viagens
                </button>
                <button class="tab-button" data-tab="routes">
                    <i class="fas fa-map-marked-alt"></i>
                    Gerenciar Rotas
                </button>
                <button class="tab-button" data-tab="tracking">
                    <i class="fas fa-map-marker-alt"></i>
                    Rastreamento
                </button>
                <button class="tab-button" data-tab="reports">
                    <i class="fas fa-chart-bar"></i>
                    Relatórios
                </button>
                <button class="tab-button" data-tab="financial">
                    <i class="fas fa-dollar-sign"></i>
                    Financeiro
                </button>
            </div>

            <!-- Tab: Dashboard -->
            <div class="tab-content active" id="dashboard-tab">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Evolução Semanal</h3>
                        <div>
                            <button class="btn btn-primary" id="refresh-dashboard">
                                <i class="fas fa-sync-alt"></i>
                                Atualizar
                            </button>
                        </div>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="dashboard-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tab: Controle de Viagens -->
            <div class="tab-content" id="trips-tab">
                <div class="trip-status-card">
                    <div class="trip-status-header">
                        <div class="status-indicator">
                            <span class="status-dot" id="trip-status-dot"></span>
                            <span class="status-text" id="trip-status-text">Nenhuma viagem ativa</span>
                        </div>
                        <div>
                            <button class="btn btn-success" id="start-trip">
                                <i class="fas fa-play"></i>
                                Iniciar Viagem
                            </button>
                            <button class="btn btn-danger" id="end-trip" style="display: none;">
                                <i class="fas fa-stop"></i>
                                Finalizar Viagem
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Container para detalhes da viagem -->
                <div id="viagem-detalhes" class="viagem-detalhes-container" style="margin: 1rem 0;"></div>

                <div class="children-list" id="children-list" style="display: none;">
                    <h3 style="margin-bottom: 1rem;">
                        <i class="fas fa-users"></i>
                        Crianças da Rota
                    </h3>
                    <div class="children-grid" id="children-grid">
                        <!-- Lista de crianças será carregada dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Tab: Gerenciar Rotas -->
            <div class="tab-content" id="routes-tab">
                <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
                    <button class="btn btn-primary" id="create-route-btn">
                        <i class="fas fa-plus"></i>
                        Criar Nova Rota
                    </button>
                    <button class="btn btn-blue" id="view-routes-btn">
                        <i class="fas fa-list"></i>
                        Ver Rotas Existentes
                    </button>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Rotas Ativas</h3>
                    </div>
                    <div id="routes-overview">
                        <p style="text-align: center; color: var(--secondary-color); padding: 2rem;">
                            <i class="fas fa-route" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                            Nenhuma rota cadastrada ainda. Clique em "Criar Nova Rota" para começar.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Tab: Rastreamento -->
            <div class="tab-content" id="tracking-tab">
                <div class="report-filters">
                    <div class="filter-group">
                        <label for="tracking-period">Período:</label>
                        <select id="tracking-period">
                            <option value="daily">Diário</option>
                            <option value="weekly">Semanal</option>
                            <option value="monthly">Mensal</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="tracking-date">Data:</label>
                        <input type="date" id="tracking-date">
                    </div>
                    <div class="filter-group">
                        <button class="btn btn-primary" id="load-tracking-report">
                            <i class="fas fa-search"></i>
                            Buscar
                        </button>
                    </div>
                </div>

                <div class="report-cards">
                    <div class="report-card">
                        <div class="report-icon trips">
                            <i class="fas fa-route"></i>
                        </div>
                        <div class="report-content">
                            <h4>Total de Viagens</h4>
                            <div class="report-value" id="tracking-trips">0</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon distance">
                            <i class="fas fa-road"></i>
                        </div>
                        <div class="report-content">
                            <h4>Distância Percorrida</h4>
                            <div class="report-value" id="tracking-distance">0 km</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon fuel">
                            <i class="fas fa-gas-pump"></i>
                        </div>
                        <div class="report-content">
                            <h4>Combustível Gasto</h4>
                            <div class="report-value" id="tracking-fuel">0 L</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon children">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="report-content">
                            <h4>Crianças Transportadas</h4>
                            <div class="report-value" id="tracking-children">0</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Histórico de Rastreamento</h3>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="tracking-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tab: Relatórios -->
            <div class="tab-content" id="reports-tab">
                <div class="report-table">
                    <div class="table-header">
                        <h3 class="table-title">Histórico de Viagens</h3>
                    </div>
                    <table id="trips-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Horário</th>
                                <th>Rota</th>
                                <th>Distância</th>
                                <th>Combustível</th>
                                <th>Crianças</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="trips-tbody">
                            <!-- Dados serão carregados dinamicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab: Financeiro -->
            <div class="tab-content" id="financial-tab">
                <div class="report-cards">
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(40, 167, 69, 0.1); color: var(--success-color);">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="report-content">
                            <h4>Receita Mensal</h4>
                            <div class="report-value" id="financial-revenue">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(220, 53, 69, 0.1); color: var(--danger-color);">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="report-content">
                            <h4>Custos Operacionais</h4>
                            <div class="report-value" id="financial-costs">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(0, 123, 255, 0.1); color: var(--primary-color);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="report-content">
                            <h4>Lucro Líquido</h4>
                            <div class="report-value" id="financial-profit">R$ 0,00</div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-icon" style="background: rgba(255, 193, 7, 0.1); color: var(--warning-color);">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="report-content">
                            <h4>Margem de Lucro</h4>
                            <div class="report-value" id="financial-margin">0%</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Evolução Financeira</h3>
                    </div>
                    <div class="chart-canvas">
                        <canvas id="financial-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificação -->
    <div id="notification" class="notification">
        <span id="notification-message"></span>
    </div>

    <!-- Modal de Cadastro de Rotas -->
    <div id="route-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-map-marked-alt"></i>
                    Criar Nova Rota
                </h2>
                <button class="close-modal" id="close-route-modal">&times;</button>
            </div>
            
            <form id="route-form" class="route-form">
                <div class="form-section">
                    <h3><i class="fas fa-info-circle"></i> Informações Básicas da Rota</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="route-name">Nome da Rota *</label>
                            <input type="text" id="route-name" name="route-name" placeholder="Ex: Rota Manhã - Centro" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-period">Período *</label>
                            <select id="route-period" name="route-period" required>
                                <option value="">Selecione o período</option>
                                <option value="manha">Manhã</option>
                                <option value="tarde">Tarde</option>
                                <option value="noite">Noite</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="route-type">Tipo de Rota *</label>
                            <select id="route-type" name="route-type" required>
                                <option value="">Selecione o tipo</option>
                                <option value="ida">Apenas Ida</option>
                                <option value="volta">Apenas Volta</option>
                                <option value="ida-volta">Ida e Volta</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Dias da Semana *</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.5rem; margin-top: 0.5rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="segunda"> Segunda
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="terca"> Terça
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="quarta"> Quarta
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="quinta"> Quinta
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="sexta"> Sexta
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal;">
                                    <input type="checkbox" name="days" value="sabado"> Sábado
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="route-observations">Observações</label>
                        <textarea id="route-observations" name="route-observations" rows="3" placeholder="Observações adicionais sobre a rota..."></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-map-pin"></i> Paradas da Rota</h3>
                    <div id="stops-container">
                        <div class="stop-item" data-stop="1">
                            <h4>Parada 1 (Primeira Parada)</h4>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Endereço *</label>
                                    <input type="text" name="stop-address" placeholder="Endereço completo da parada" required>
                         </div>
                         <div class="form-group">
                             <label>Horário *</label>
                             <input type="time" name="stop-time" required>
                         </div>
                         <div class="form-group">
                             <label>Ponto de Referência</label>
                             <input type="text" name="stop-reference" placeholder="Ex: Próximo ao supermercado">
                         </div>
                     </div>
                     <div class="form-group">
                         <label>Crianças nesta parada</label>
                         <select name="stop-children" multiple style="height: 100px;">
                             <!-- Opções serão carregadas dinamicamente -->
                         </select>
                         <small style="color: var(--secondary-color); margin-top: 0.25rem;">Segure Ctrl para selecionar múltiplas crianças</small>
                     </div>
                 </div>
             `;
             
             loadChildrenOptions();
         }

         function addNewStop() {
             stopCounter++;
             const stopsContainer = document.getElementById('stops-container');
             
             const stopHtml = `
                 <div class="stop-item" data-stop="${stopCounter}">
                     <h4>Parada ${stopCounter}</h4>
                     <div class="form-grid">
                         <div class="form-group">
                             <label>Endereço *</label>
                             <input type="text" name="stop-address" placeholder="Endereço completo da parada" required>
                         </div>
                         <div class="form-group">
                             <label>Horário *</label>
                             <input type="time" name="stop-time" required>
                         </div>
                         <div class="form-group">
                             <label>Ponto de Referência</label>
                             <input type="text" name="stop-reference" placeholder="Ex: Próximo ao supermercado">
                         </div>
                     </div>
                     <div class="form-group">
                         <label>Crianças nesta parada</label>
                         <select name="stop-children" multiple style="height: 100px;">
                             <!-- Opções serão carregadas dinamicamente -->
                         </select>
                         <small style="color: var(--secondary-color); margin-top: 0.25rem;">Segure Ctrl para selecionar múltiplas crianças</small>
                     </div>
                     <button type="button" class="btn btn-danger" onclick="removeStop(${stopCounter})" style="margin-top: 1rem;">
                         <i class="fas fa-trash"></i>
                         Remover Parada
                     </button>
                 </div>
             `;
             
             stopsContainer.insertAdjacentHTML('beforeend', stopHtml);
             loadChildrenOptions();
         }

         function removeStop(stopNumber) {
             if (stopNumber === 1) {
                 showNotification('A primeira parada não pode ser removida!', 'warning');
                 return;
             }
             
             const stopElement = document.querySelector(`[data-stop="${stopNumber}"]`);
             if (stopElement) {
                 stopElement.remove();
                 updateStopNumbers();
             }
         }

         function updateStopNumbers() {
             const stops = document.querySelectorAll('.stop-item');
             stops.forEach((stop, index) => {
                 const stopNumber = index + 1;
                 stop.setAttribute('data-stop', stopNumber);
                 
                 const title = stop.querySelector('h4');
                 if (stopNumber === 1) {
                     title.textContent = 'Parada 1 (Primeira Parada)';
                 } else {
                     title.textContent = `Parada ${stopNumber}`;
                 }
             });
             
             stopCounter = stops.length;
         }

         function loadChildrenOptions() {
             // Simular dados de crianças - em produção, viria da API
             const children = [
                 { id: 1, name: 'Ana Silva', school: 'Escola Municipal' },
                 { id: 2, name: 'João Santos', school: 'Colégio Estadual' },
                 { id: 3, name: 'Maria Oliveira', school: 'Escola Municipal' },
                 { id: 4, name: 'Pedro Costa', school: 'Colégio Particular' },
                 { id: 5, name: 'Sofia Lima', school: 'Escola Municipal' }
             ];

             const selects = document.querySelectorAll('select[name*="children"]');
             selects.forEach(select => {
                 select.innerHTML = '';
                 children.forEach(child => {
                     const option = document.createElement('option');
                     option.value = child.id;
                     option.textContent = `${child.name} - ${child.school}`;
                     select.appendChild(option);
                 });
             });
         }

         function saveRoute() {
             const formData = new FormData(document.getElementById('route-form'));
             const routeData = {
                 name: formData.get('route-name'),
                 period: formData.get('route-period'),
                 type: formData.get('route-type'),
                 days: formData.getAll('days'),
                 observations: formData.get('route-observations'),
                 stops: []
             };

             // Coletar dados das paradas
             const stops = document.querySelectorAll('.stop-item');
             stops.forEach((stop, index) => {
                 const inputs = stop.querySelectorAll('input, select');
                 const stopData = {
                     number: index + 1,
                     address: stop.querySelector('input[name="stop-address"]').value,
                     time: stop.querySelector('input[name="stop-time"]').value,
                     reference: stop.querySelector('input[name="stop-reference"]').value,
                     children: Array.from(stop.querySelector('select[name="stop-children"]').selectedOptions).map(opt => opt.value)
                 };
                 routeData.stops.push(stopData);
             });

             // Validações
             if (!routeData.name || !routeData.period || !routeData.type) {
                 showNotification('Por favor, preencha todos os campos obrigatórios.', 'warning');
                 return;
             }

             if (routeData.days.length === 0) {
                 showNotification('Selecione pelo menos um dia da semana.', 'warning');
                 return;
             }

             if (routeData.stops.length === 0) {
                 showNotification('Adicione pelo menos uma parada.', 'warning');
                 return;
             }

             // Simular salvamento
             currentRoutes.push({
                 id: Date.now(),
                 name: routeData.name,
                 period: routeData.period,
                 type: routeData.type,
                 stops: routeData.stops,
                 active: true
             });

             showNotification('Rota salva com sucesso!', 'success');
             closeModal(document.getElementById('route-modal'));
             loadRoutesOverview();
         }

         function loadRoutesList() {
             const routesList = document.getElementById('routes-list');
             
             if (currentRoutes.length === 0) {
                 routesList.innerHTML = '<p style="text-align: center; color: var(--secondary-color);">Nenhuma rota cadastrada ainda.</p>';
                 return;
             }

             routesList.innerHTML = currentRoutes.map(route => `
                 <div style="background: var(--white); border: 1px solid var(--border-color); border-radius: var(--border-radius); padding: 1rem; margin-bottom: 1rem;">
                     <h4 style="margin: 0 0 0.5rem 0;">${route.name}</h4>
                     <p style="margin: 0; color: var(--secondary-color); font-size: 0.9rem;">
                         ${route.period} • ${route.type} • ${route.stops.length} paradas
                     </p>
                     <div style="margin-top: 0.5rem;">
                         <span style="padding: 2px 8px; background: ${route.active ? 'var(--success-color)' : 'var(--danger-color)'}; color: white; border-radius: 12px; font-size: 0.8rem;">
                             ${route.active ? 'Ativa' : 'Inativa'}
                         </span>
                     </div>
                 </div>
             `).join('');
         }

         // Funções de gráficos
         function initializeCharts() {
             // Inicializar gráficos vazios
             updateDashboardChart();
             updateTrackingChart();
             updateFinancialChart();
         }

         function updateDashboardChart() {
             const ctx = document.getElementById('dashboard-chart');
             if (!ctx) return;

             if (charts.dashboard) {
                 charts.dashboard.destroy();
             }

             charts.dashboard = new Chart(ctx, {
                 type: 'line',
                 data: {
                     labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                     datasets: [{
                         label: 'Viagens',
                         data: [12, 19, 8, 15, 22, 18, 14],
                         borderColor: 'var(--primary-color)',
                         backgroundColor: 'rgba(0, 123, 255, 0.1)',
                         tension: 0.4
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             display: false
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateTrackingChart() {
             const ctx = document.getElementById('tracking-chart');
             if (!ctx) return;

             if (charts.tracking) {
                 charts.tracking.destroy();
             }

             charts.tracking = new Chart(ctx, {
                 type: 'bar',
                 data: {
                     labels: ['01/10', '02/10', '03/10', '04/10', '05/10'],
                     datasets: [{
                         label: 'Distância (km)',
                         data: [25, 30, 22, 28, 35],
                         backgroundColor: 'var(--success-color)'
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             display: false
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateFinancialChart() {
             const ctx = document.getElementById('financial-chart');
             if (!ctx) return;

             if (charts.financial) {
                 charts.financial.destroy();
             }

             charts.financial = new Chart(ctx, {
                 type: 'line',
                 data: {
                     labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                     datasets: [{
                         label: 'Receita',
                         data: [2500, 2800, 3200, 2900, 3500, 4250],
                         borderColor: 'var(--success-color)',
                         backgroundColor: 'rgba(40, 167, 69, 0.1)',
                         tension: 0.4
                     }, {
                         label: 'Custos',
                         data: [1800, 2000, 2200, 2100, 2400, 1890],
                         borderColor: 'var(--danger-color)',
                         backgroundColor: 'rgba(220, 53, 69, 0.1)',
                         tension: 0.4
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             position: 'top'
                         }
                     },
                     scales: {
                         y: {
                             beginAtZero: true
                         }
                     }
                 }
             });
         }

         function updateChartsTheme() {
             // Atualizar cores dos gráficos baseado no tema
             Object.values(charts).forEach(chart => {
                 if (chart) {
                     chart.update();
                 }
             });
         }

         function showNotification(message, type = 'info') {
             const notification = document.getElementById('notification');
             const messageElement = document.getElementById('notification-message');
             
             messageElement.textContent = message;
             notification.className = `notification ${type}`;
             notification.classList.add('show');

             setTimeout(() => {
                 notification.classList.remove('show');
             }, 3000);
         }

         // Tornar funções globais para uso nos botões
         window.checkIn = checkIn;
         window.checkOut = checkOut;
         window.removeStop = removeStop;
     </script>
</body>
</html> required>
                                </div>
                                <div class="form-group">
                                    <label>Horário *</label>
                                    <input type="time" name="stop-time" required>
                                </div>
                                <div class="form-group">
                                    <label>Ponto de Referência</label>
                                    <input type="text" name="stop-reference" placeholder="Ex: Próximo ao supermercado">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Crianças nesta parada</label>
                                <select name="stop-children" multiple style="height: 100px;">
                                    <!-- Opções serão carregadas dinamicamente -->
                                </select>
                                <small style="color: var(--secondary-color); margin-top: 0.25rem;">Segure Ctrl para selecionar múltiplas crianças</small>
                            </div>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-blue" id="add-stop-btn">
                        <i class="fas fa-plus"></i>
                        Adicionar Parada
                    </button>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                    <button type="button" class="btn" style="background: var(--secondary-color); color: white;" id="cancel-route-btn">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i>
                        Salvar Rota
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Visualização de Rotas -->
    <div id="routes-list-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-list"></i>
                    Rotas Cadastradas
                </h2>
                <button class="close-modal" id="close-routes-list-modal">&times;</button>
            </div>
            
            <div class="routes-list" id="routes-list" style="padding: 1.5rem;">
                <!-- Lista de rotas será carregada dinamicamente -->
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let currentTrip = null;
        let charts = {};
        let isDarkTheme = localStorage.getItem('theme') === 'dark' || false;
        let token = localStorage.getItem('authToken');

        // Variáveis para rotas
        let stopCounter = 1;
        let currentRoutes = [];



        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Aplicar tema salvo
            if (isDarkTheme) {
                document.body.classList.add('dark-theme');
            }
            
            // Configurar event listeners
            setupEventListeners();
            
            // Inicializar aplicação
            initializeApp();
            loadUserData();
            // loadDashboardData(); // Comentado temporariamente para teste das abas
            // setupRouteEventListeners(); // Comentado temporariamente para teste das abas
            
            // Mostrar primeira aba por padrão
            switchTab('dashboard');
        });

        function initializeApp() {
            // Verificar tema salvo
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }

            // Verificar autenticação (apenas em produção)
            if (!token && window.location.hostname !== 'localhost') {
                window.location.href = 'login.html';
                return;
            }

            // Inicializar gráficos (comentado temporariamente para teste das abas)
            // initializeCharts();
        }

        function setupEventListeners() {
            // Navegação por abas
            const tabButtons = document.querySelectorAll('.tab-button');
            
            tabButtons.forEach((button) => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });

            // Toggle de tema
            const themeToggle = document.getElementById('theme-toggle');
            
            if (themeToggle) {
                themeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    toggleTheme();
                });
            }

            // Controle de viagem
            document.getElementById('start-trip').addEventListener('click', startTrip);
            document.getElementById('end-trip').addEventListener('click', endTrip);

            // Atualizar dashboard
            document.getElementById('refresh-dashboard').addEventListener('click', function() {
                this.classList.add('loading');
                loadDashboardData();
                setTimeout(() => this.classList.remove('loading'), 1000);
            });

            // Relatórios de rastreamento
            document.getElementById('load-tracking-report').addEventListener('click', loadTrackingReport);

            // Logout
            document.getElementById('logout-button').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('Tem certeza que deseja sair?')) {
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html';
                }
            });
        }

        function setupRouteEventListeners() {
            // Elementos do DOM para rotas
            const routeModal = document.getElementById('route-modal');
            const routesListModal = document.getElementById('routes-list-modal');
            const createRouteBtn = document.getElementById('create-route-btn');
            const viewRoutesBtn = document.getElementById('view-routes-btn');
            const routeForm = document.getElementById('route-form');
            const addStopBtn = document.getElementById('add-stop-btn');

            // Event Listeners para abrir modais
            createRouteBtn?.addEventListener('click', openRouteModal);
            viewRoutesBtn?.addEventListener('click', openRoutesListModal);

            // Event Listeners para fechar modais
            document.getElementById('close-route-modal')?.addEventListener('click', () => {
                closeModal(routeModal);
            });

            document.getElementById('close-routes-list-modal')?.addEventListener('click', () => {
                closeModal(routesListModal);
            });

            document.getElementById('cancel-route-btn')?.addEventListener('click', () => {
                closeModal(routeModal);
            });

            // Fechar modal ao clicar fora
            routeModal?.addEventListener('click', (e) => {
                if (e.target === routeModal) {
                    closeModal(routeModal);
                }
            });

            routesListModal?.addEventListener('click', (e) => {
                if (e.target === routesListModal) {
                    closeModal(routesListModal);
                }
            });

            // Event Listener para adicionar parada
            addStopBtn?.addEventListener('click', addNewStop);

            // Event Listener para submissão do formulário
            routeForm?.addEventListener('submit', (e) => {
                e.preventDefault();
                saveRoute();
            });
        }

        function switchTab(tabId) {
            // Remover classe active de todos os botões e conteúdos
            const allButtons = document.querySelectorAll('.tab-button');
            const allContents = document.querySelectorAll('.tab-content');
            
            allButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            allContents.forEach(content => {
                content.classList.remove('active');
            });

            // Adicionar classe active ao botão e conteúdo selecionados
            const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
            const tabContent = document.getElementById(`${tabId}-tab`);
            
            if (tabButton) {
                tabButton.classList.add('active');
            }
            
            if (tabContent) {
                tabContent.classList.add('active');
            }

            // Carregar dados específicos da aba se necessário
            if (tabId === 'tracking') {
                loadTrackingReport();
            } else if (tabId === 'reports') {
                loadReportsData();
            } else if (tabId === 'financial') {
                loadFinancialData();
            } else if (tabId === 'routes') {
                loadRoutesOverview();
            }
        }

        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            const body = document.body;
            const themeIcon = document.querySelector('#theme-toggle i');

            if (isDarkTheme) {
                body.classList.add('dark-theme');
                body.setAttribute('data-theme', 'dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-sun';
                }
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark-theme');
                body.removeAttribute('data-theme');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-moon';
                }
                localStorage.setItem('theme', 'light');
            }

            // Atualizar gráficos com novo tema
            if (typeof updateChartsTheme === 'function') {
                updateChartsTheme();
            }
            
            // Mostrar notificação
            showNotification(`Tema ${isDarkTheme ? 'escuro' : 'claro'} ativado!`, 'info');
        }

        function loadUserData() {
            // Simular carregamento de dados do usuário
            // Em produção, fazer requisição para API
        }

        function loadDashboardData() {
            // Simular dados do dashboard
            document.getElementById('trips-today').textContent = '8';
            document.getElementById('trips-change').textContent = '+12% vs ontem';
            
            document.getElementById('monthly-revenue').textContent = 'R$ 4.250';
            document.getElementById('revenue-change').textContent = '+8% vs mês anterior';
            
            document.getElementById('active-children').textContent = '24';
            document.getElementById('children-change').textContent = '+2 novos';
            
            document.getElementById('total-distance').textContent = '156 km';
            document.getElementById('distance-change').textContent = '+23 km hoje';

            // Atualizar gráfico do dashboard
            updateDashboardChart();
        }

        function loadTrackingReport() {
            const period = document.getElementById('tracking-period').value;
            const date = document.getElementById('tracking-date').value;

            // Simular dados de rastreamento
            document.getElementById('tracking-trips').textContent = '12';
            document.getElementById('tracking-distance').textContent = '245 km';
            document.getElementById('tracking-fuel').textContent = '28 L';
            document.getElementById('tracking-children').textContent = '36';

            updateTrackingChart();
        }

        function loadReportsData() {
            // Simular dados de relatórios
            const tbody = document.getElementById('trips-tbody');
            tbody.innerHTML = `
                <tr>
                    <td>18/10/2024</td>
                    <td>07:30</td>
                    <td>Rota Manhã - Centro</td>
                    <td>15.2 km</td>
                    <td>2.1 L</td>
                    <td>8</td>
                    <td><span style="color: var(--success-color);">Concluída</span></td>
                </tr>
                <tr>
                    <td>18/10/2024</td>
                    <td>12:00</td>
                    <td>Rota Tarde - Bairro Norte</td>
                    <td>18.7 km</td>
                    <td>2.5 L</td>
                    <td>12</td>
                    <td><span style="color: var(--success-color);">Concluída</span></td>
                </tr>
            `;
        }

        function loadFinancialData() {
            // Simular dados financeiros
            document.getElementById('financial-revenue').textContent = 'R$ 4.250,00';
            document.getElementById('financial-costs').textContent = 'R$ 1.890,00';
            document.getElementById('financial-profit').textContent = 'R$ 2.360,00';
            document.getElementById('financial-margin').textContent = '55.5%';

            updateFinancialChart();
        }

        function loadRoutesOverview() {
            // Carregar overview das rotas
            const overview = document.getElementById('routes-overview');
            
            if (currentRoutes.length === 0) {
                overview.innerHTML = `
                    <p style="text-align: center; color: var(--secondary-color); padding: 2rem;">
                        <i class="fas fa-route" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                        Nenhuma rota cadastrada ainda. Clique em "Criar Nova Rota" para começar.
                    </p>
                `;
            } else {
                // Mostrar resumo das rotas
                overview.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        ${currentRoutes.map(route => `
                            <div style="background: var(--light-color); padding: 1rem; border-radius: var(--border-radius); border-left: 4px solid var(--primary-color);">
                                <h4 style="margin: 0 0 0.5rem 0;">${route.name}</h4>
                                <p style="margin: 0; color: var(--secondary-color); font-size: 0.9rem;">
                                    ${route.period} • ${route.type} • ${route.stops.length} paradas
                                </p>
                                <div style="margin-top: 0.5rem;">
                                    <span style="padding: 2px 8px; background: ${route.active ? 'var(--success-color)' : 'var(--danger-color)'}; color: white; border-radius: 12px; font-size: 0.8rem;">
                                        ${route.active ? 'Ativa' : 'Inativa'}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        function startTrip() {
            const statusDot = document.getElementById('trip-status-dot');
            const statusText = document.getElementById('trip-status-text');
            const startBtn = document.getElementById('start-trip');
            const endBtn = document.getElementById('end-trip');
            const childrenList = document.getElementById('children-list');

            // Simular início de viagem
            currentTrip = {
                id: Date.now(),
                startTime: new Date(),
                children: [
                    { id: 1, name: 'Ana Silva', address: 'Rua A, 123', status: 'waiting' },
                    { id: 2, name: 'João Santos', address: 'Rua B, 456', status: 'waiting' },
                    { id: 3, name: 'Maria Oliveira', address: 'Rua C, 789', status: 'waiting' }
                ]
            };

            statusDot.classList.add('active');
            statusText.textContent = 'Viagem em andamento';
            startBtn.style.display = 'none';
            endBtn.style.display = 'inline-flex';
            childrenList.style.display = 'block';

            loadChildrenList();
            showNotification('Viagem iniciada com sucesso!', 'success');
        }

        function endTrip() {
            const statusDot = document.getElementById('trip-status-dot');
            const statusText = document.getElementById('trip-status-text');
            const startBtn = document.getElementById('start-trip');
            const endBtn = document.getElementById('end-trip');
            const childrenList = document.getElementById('children-list');

            if (confirm('Tem certeza que deseja finalizar a viagem?')) {
                currentTrip = null;
                
                statusDot.classList.remove('active');
                statusText.textContent = 'Nenhuma viagem ativa';
                startBtn.style.display = 'inline-flex';
                endBtn.style.display = 'none';
                childrenList.style.display = 'none';

                showNotification('Viagem finalizada com sucesso!', 'success');
            }
        }

        function loadChildrenList() {
            const grid = document.getElementById('children-grid');
            
            if (!currentTrip) return;

            grid.innerHTML = currentTrip.children.map(child => `
                <div class="child-card ${child.status === 'checked-in' ? 'checked-in' : child.status === 'checked-out' ? 'checked-out' : ''}">
                    <div class="child-info">
                        <div class="child-name">${child.name}</div>
                        <div class="child-details">${child.address}</div>
                    </div>
                    <div class="child-actions">
                        <button class="btn btn-success" onclick="checkIn(${child.id})" ${child.status === 'checked-in' ? 'disabled' : ''}>
                            <i class="fas fa-sign-in-alt"></i>
                            Check-in
                        </button>
                        <button class="btn btn-danger" onclick="checkOut(${child.id})" ${child.status !== 'checked-in' ? 'disabled' : ''}>
                            <i class="fas fa-sign-out-alt"></i>
                            Check-out
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function checkIn(childId) {
            if (!currentTrip) return;
            
            const child = currentTrip.children.find(c => c.id === childId);
            if (child) {
                child.status = 'checked-in';
                loadChildrenList();
                showNotification(`${child.name} fez check-in!`, 'success');
            }
        }

        function checkOut(childId) {
            if (!currentTrip) return;
            
            const child = currentTrip.children.find(c => c.id === childId);
            if (child) {
                child.status = 'checked-out';
                loadChildrenList();
                showNotification(`${child.name} fez check-out!`, 'info');
            }
        }

        // Funções para rotas
        function openRouteModal() {
            resetRouteForm();
            loadChildrenOptions();
            document.getElementById('route-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function openRoutesListModal() {
            loadRoutesList();
            document.getElementById('routes-list-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        function resetRouteForm() {
            document.getElementById('route-form').reset();
            stopCounter = 1;
            
            const stopsContainer = document.getElementById('stops-container');
            stopsContainer.innerHTML = `
                <div class="stop-item" data-stop="1">
                    <h4>Parada 1 (Primeira Parada)</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Endereço *</label>
                            <input type="text" name="stop-address" placeholder="Endereço completo da parada" required>
                        </div>
                        <div class="form-group">
                            <label>Horário *</label>
                            <input type="time" name="stop-time" required>
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>